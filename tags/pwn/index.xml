<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pwn on circleous</title><link>https://blog.circleo.us/tags/pwn/</link><description>Recent content in Pwn on circleous</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Mon, 18 Apr 2022 00:00:00 +0700</lastBuildDate><atom:link href="https://blog.circleo.us/tags/pwn/index.xml" rel="self" type="application/rss+xml"/><item><title>crewctf 2022 - qKarachter</title><link>https://blog.circleo.us/posts/crewctf-2022-qkarachter/</link><pubDate>Mon, 18 Apr 2022 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/crewctf-2022-qkarachter/</guid><description>&lt;p&gt;qKarachter was a kernel challenge, which provided a misc device that can be interacted with ioctl(2).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-c" data-lang="c"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bb9af7"&gt;typedef&lt;/span&gt; &lt;span style="color:#bb9af7"&gt;struct&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#41a6b5"&gt;unsigned&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; length;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#41a6b5"&gt;unsigned&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; idx;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#41a6b5"&gt;char&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt; data; &lt;span style="color:#414868;font-style:italic"&gt;// ptr to char[144]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;} req;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; &lt;span style="color:#7aa2f7"&gt;handle_ioctl&lt;/span&gt;(&lt;span style="color:#bb9af7"&gt;__int64&lt;/span&gt; a1, &lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; cmd, req &lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt;arg) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; req &lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt;req;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; req &lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt;_req;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; result;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;mutex_lock&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;mutex); &lt;span style="color:#414868;font-style:italic"&gt;// global lock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; req &lt;span style="color:#9ece6a;font-weight:bold"&gt;=&lt;/span&gt; (req &lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt;)&lt;span style="color:#7aa2f7"&gt;kmem_cache_alloc_trace&lt;/span&gt;(kmalloc_caches[&lt;span style="color:#e0af68"&gt;4&lt;/span&gt;], &lt;span style="color:#e0af68"&gt;3264LL&lt;/span&gt;, &lt;span style="color:#e0af68"&gt;16LL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;if&lt;/span&gt; (&lt;span style="color:#9ece6a;font-weight:bold"&gt;!&lt;/span&gt;req) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;printk&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;str_malloc_failed);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;mutex_unlock&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;mutex);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;return&lt;/span&gt; &lt;span style="color:#9ece6a;font-weight:bold"&gt;-&lt;/span&gt;ENOMEM;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; _req &lt;span style="color:#9ece6a;font-weight:bold"&gt;=&lt;/span&gt; req;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;if&lt;/span&gt; (&lt;span style="color:#7aa2f7"&gt;copy_from_user&lt;/span&gt;(req, arg, &lt;span style="color:#e0af68"&gt;16LL&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;printk&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;str_copy_from_user_failed);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;return&lt;/span&gt; &lt;span style="color:#9ece6a;font-weight:bold"&gt;-&lt;/span&gt;EAGAIN;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;switch&lt;/span&gt; (cmd) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;case&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0x1338&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result &lt;span style="color:#9ece6a;font-weight:bold"&gt;=&lt;/span&gt; &lt;span style="color:#7aa2f7"&gt;readData&lt;/span&gt;(_req);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;goto&lt;/span&gt; _success;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;case&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0x1339&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result &lt;span style="color:#9ece6a;font-weight:bold"&gt;=&lt;/span&gt; &lt;span style="color:#7aa2f7"&gt;delData&lt;/span&gt;(_req&lt;span style="color:#9ece6a;font-weight:bold"&gt;-&amp;gt;&lt;/span&gt;idx);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;goto&lt;/span&gt; _success;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;case&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0x1337&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result &lt;span style="color:#9ece6a;font-weight:bold"&gt;=&lt;/span&gt; &lt;span style="color:#7aa2f7"&gt;addData&lt;/span&gt;(_req);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;goto&lt;/span&gt; _success;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;default&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;printk&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;str_invalid_choice);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;mutex_unlock&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;mutex);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;return&lt;/span&gt; &lt;span style="color:#9ece6a;font-weight:bold"&gt;-&lt;/span&gt;EINVAL;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#9ece6a"&gt;_success&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;kfree&lt;/span&gt;(_req);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#7aa2f7"&gt;mutex_unlock&lt;/span&gt;(&lt;span style="color:#9ece6a;font-weight:bold"&gt;&amp;amp;&lt;/span&gt;mutex);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#bb9af7"&gt;return&lt;/span&gt; result;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Data are created in &lt;code&gt;addData&lt;/code&gt; with size of kmalloc-128 and the pointer to it are stored in global array &lt;code&gt;ptrArr&lt;/code&gt;.&lt;/p&gt;</description></item><item><title>N1CTF 2021 - ctfhub2</title><link>https://blog.circleo.us/posts/n1ctf-2021-ctfhub2/</link><pubDate>Mon, 22 Nov 2021 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/n1ctf-2021-ctfhub2/</guid><description>&lt;blockquote&gt;
&lt;p&gt;You must have noticed something pwnable in MISC-ctfhub. This time I setup ANOTHER php environment with &lt;a href="http://crypt.so"&gt;crypt.so&lt;/a&gt; ( you can use all the functions in ffi.inc.php too just like ctfhub ) and disable some dangerous functions. You are expected to execute /readflag and get flag. Good luck :D.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="initial-analysis"&gt;Initial Analysis&lt;/h2&gt;
&lt;p&gt;I didn&amp;rsquo;t reverse crypt.so even until the end of the competition, but it only has 2 simple exported function,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-c" data-lang="c"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#414868;font-style:italic"&gt;#define FFI_LIB &amp;#34;../crypt.so&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#414868;font-style:italic"&gt;#define FFI_SCOPE &amp;#34;crypt&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#41a6b5"&gt;void&lt;/span&gt; &lt;span style="color:#7aa2f7"&gt;encrypt&lt;/span&gt;(&lt;span style="color:#41a6b5"&gt;void&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt; in,&lt;span style="color:#41a6b5"&gt;unsigned&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; size,&lt;span style="color:#41a6b5"&gt;unsigned&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;long&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;long&lt;/span&gt; key,&lt;span style="color:#41a6b5"&gt;void&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt; out);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#41a6b5"&gt;void&lt;/span&gt; &lt;span style="color:#7aa2f7"&gt;decrypt&lt;/span&gt;(&lt;span style="color:#41a6b5"&gt;void&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt; in,&lt;span style="color:#41a6b5"&gt;unsigned&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;int&lt;/span&gt; size,&lt;span style="color:#41a6b5"&gt;unsigned&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;long&lt;/span&gt; &lt;span style="color:#41a6b5"&gt;long&lt;/span&gt; key,&lt;span style="color:#41a6b5"&gt;void&lt;/span&gt;&lt;span style="color:#9ece6a;font-weight:bold"&gt;*&lt;/span&gt; out);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Design wise, you can actually see there&amp;rsquo;s a flaw from the parameters alone. It takes 2 pointer to input and output buffer, but only take 1 size for input as parameter. This could mean output buffer length isn&amp;rsquo;t checked. Nothing too serious, but if the one that uses the library are not careful it could leads to something unexpected. It could be ok-ish, but it shows overflow could happen if the output buffer isn&amp;rsquo;t as big as it should be. The first step is to get to know how these 2 functions works. So, I created a small C program to test it out,&lt;/p&gt;</description></item><item><title>CyberJawara 2021 Quals - PWN</title><link>https://blog.circleo.us/posts/cyberjawara-2021-quals-pwn/</link><pubDate>Fri, 19 Nov 2021 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/cyberjawara-2021-quals-pwn/</guid><description>&lt;p&gt;Penulisan editorial berurut dari yang paling banyak dikerjakan sampai paling sedikit, &lt;em&gt;scroll&lt;/em&gt; ke bawah untuk detail cara mendapatkan bounty 100k GOPAY dari soal &lt;em&gt;quick maffs&lt;/em&gt;. Any question? Discord: &lt;code&gt;circleous#0587&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="1-heapnote"&gt;1. Heapnote&lt;/h2&gt;
&lt;p&gt;Bug pada soal terletak pada Use after Free, namun karena ukuran &lt;code&gt;malloc&lt;/code&gt; statis perlu buat fake chunk terlebih dulu cukup besar untuk bisa mendapatkan unsorted bin. Detail writeup untuk soal tidak akan saya tulis karena writeup soal bertemakan heap ini sudah banyak. Tidak bermaksud untuk promosi :p, tapi series Linux Heap Exploitation dari Max Kamper &lt;a href="https://www.udemy.com/course/linux-heap-exploitation-part-1/"&gt;https://www.udemy.com/course/linux-heap-exploitation-part-1/&lt;/a&gt; itu bagus untuk yang lebih enak belajar dengan video.&lt;/p&gt;</description></item><item><title>IJCTF 2020 - builtinhttp</title><link>https://blog.circleo.us/posts/ijctf-2020-builtinhttp/</link><pubDate>Mon, 27 Apr 2020 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/ijctf-2020-builtinhttp/</guid><description>&lt;p&gt;The intended solution was using a buffer overflow on &lt;code&gt;[^fopen_test:%arg_path%^]&lt;/code&gt;. I did notice this bug first since I&amp;rsquo;m guessing that the binary should have a buffer overflow because there is no stack canary. The problem is that, I don&amp;rsquo;t know there exist sqlite ATTACH DATABASE which you can use it to write into file system and then use it with fopen_test to pwn. The another bug I found was the sqlite injection and use fts3 module, this is something I didn&amp;rsquo;t want to touch first since I know the fopen_test bug, but since I don&amp;rsquo;t have any option left (It has been 6 hours finding how to write file into system and I still didn&amp;rsquo;t know how to do it), I decided to use fts3 module exploit. Go to author excellent write-up on built_in_http to get the gist of this challenge &lt;a href="https://vuln.live/blog/9"&gt;https://vuln.live/blog/9&lt;/a&gt;. I&amp;rsquo;ll not discuss deeper on the reversing part, just the basic idea of exploiting sqlite fts3 module and try to add some comments how I solved this challenge.&lt;/p&gt;</description></item><item><title>TAMUCTF 2021 - Sevent Core of Hell</title><link>https://blog.circleo.us/posts/tamuctf-2021-sevent-core-of-hell/</link><pubDate>Sun, 26 Apr 2020 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/tamuctf-2021-sevent-core-of-hell/</guid><description>&lt;p&gt;We are given a source of a flask application and the content is in this &lt;a href="https://gist.github.com/circleous/007f4a30cb4a8472fdf893c63582404c"&gt;gist&lt;/a&gt;, if you don&amp;rsquo;t want to read the code, here is a TL;DR version of the flask app capabilities:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;app.secret_key is initialized with random.choice(digits+ascii_letters)&lt;/li&gt;
&lt;li&gt;To login as admin, the password is also checked with random.choice(digits+ascii_letters) repeated 256 times&lt;/li&gt;
&lt;li&gt;As an admin, we can do much more stuff like upload a file, upload a tar file, and browse or read files. The pathname is strictly checked from any LFI attempt, so we can&amp;rsquo;t do any LFI.&lt;/li&gt;
&lt;li&gt;We have /dump/ route which will make a core dump of the current flask app and let us download it.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="first-stage---bake-the-cookie"&gt;First Stage - Bake the Cookie&lt;/h3&gt;
&lt;p&gt;The first stage is clear, now we have to elevate our user as an admin, but since the password is checked with random.choice every time, we have to find another way. We have a /dump/ route which will make a core dump of the current running flask app. A core dump is a memory snapshot of the app, so maybe we can search for app.secret_key and use it to forge a cookie. But how do we find a 256 bytes string on a huge ~90MB-ish file? Now comes the first pain. In python, you can use id() to get the object address. For example&lt;/p&gt;</description></item><item><title>Wreck IT CTF 2019 Writeup</title><link>https://blog.circleo.us/posts/wreck-it-2019-ctf-writeup/</link><pubDate>Sun, 29 Sep 2019 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/wreck-it-2019-ctf-writeup/</guid><description>&lt;h1 id="1ot"&gt;1ot&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Setelah galau dengan permasalahan UEFI-nya, kini Bambang beralih mempergunakan sistim perangkat kokoh lainnya yang dirasa lebih mudah. Namun naga-naganya, sistim perangkat kokoh tersebut terproteksi dengan password juga. Bantu Bambang menemukan jawaban. ;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sedikit recon pada file yang diberikan dengan membaca headernya dan analisa strings&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#c0caf5;background-color:#1a1b26;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ head -c &lt;span style="color:#e0af68"&gt;32&lt;/span&gt; ./1ot.bin | xxd
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;00000000: 5f5f 464d &lt;span style="color:#e0af68"&gt;4150&lt;/span&gt; 5f5f &lt;span style="color:#e0af68"&gt;0101&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0000&lt;/span&gt; c0ff &lt;span style="color:#e0af68"&gt;0000&lt;/span&gt; __FMAP__........
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;00000010: &lt;span style="color:#e0af68"&gt;0000&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0000&lt;/span&gt; &lt;span style="color:#e0af68"&gt;4000&lt;/span&gt; 464c &lt;span style="color:#e0af68"&gt;4153&lt;/span&gt; &lt;span style="color:#e0af68"&gt;4800&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0000&lt;/span&gt; &lt;span style="color:#e0af68"&gt;0000&lt;/span&gt; &lt;span style="color:#9ece6a;font-weight:bold"&gt;[&lt;/span&gt;emailÂ protected&lt;span style="color:#9ece6a;font-weight:bold"&gt;]&lt;/span&gt;.....
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ strings ./1ot.bin
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;CBFS: Locating &lt;span style="color:#9ece6a"&gt;&amp;#39;%s&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;CBFS: Found @ offset %zx size %zx
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;CBFS: &lt;span style="color:#9ece6a"&gt;&amp;#39;%s&amp;#39;&lt;/span&gt; not found.
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;coreboot-%s%s %s romstage starting &lt;span style="color:#9ece6a;font-weight:bold"&gt;(&lt;/span&gt;log level: %i&lt;span style="color:#9ece6a;font-weight:bold"&gt;)&lt;/span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;0123456789abcdef
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;0123456789ABCDEF
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;dengan google-fu, &lt;code&gt;FMAP&lt;/code&gt; ini ternyata flashmap files, &amp;ldquo;flashmap, a firmware layout description format allowing to have multipleCBFSes&amp;rdquo;. dan ada string &lt;code&gt;coreboot&lt;/code&gt;, OSS project untuk firmware bios. Untuk extract file bios ini, saya mengikuti langkah-langkah dari &lt;a href="https://www.chromium.org/chromium-os/developer-information-for-chrome-os-devices/samsung-sandy-bridge/coreboot-vmx-hack#TOC-Extracting-The-BIOS"&gt;Hacking VMX Support Into Coreboot#Extracting The BIOS&lt;/a&gt;.&lt;/p&gt;</description></item><item><title>COMPFEST 11 Final - Fruity Goodness</title><link>https://blog.circleo.us/posts/compfest-11-final-fruity-goodness/</link><pubDate>Mon, 09 Sep 2019 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/compfest-11-final-fruity-goodness/</guid><description>&lt;blockquote&gt;
&lt;p&gt;hanya soal ini yang saya selesaikan selama ctf berlangsung, sad af.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id="analisa"&gt;analisa&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;==================================================
WELCOME TO FRUIT WAR v6.9
I'm still a noob C coder :(, please report any bugs you find
I'm also poor so i cant pay you :(
Hopefully you have fun!
==================================================
1. I want a new fruit
2. I want to train my fruit
3. I want to list all my fruits
4. I want out :(
Your choice:
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Soal heap dengan fungsi &lt;code&gt;view()&lt;/code&gt;, &lt;code&gt;add()&lt;/code&gt;, dan &lt;code&gt;edit()&lt;/code&gt;, tanpa free/&lt;code&gt;delete()&lt;/code&gt;. Struktur dari &lt;code&gt;fruit&lt;/code&gt;,&lt;/p&gt;</description></item><item><title>HackToday 2019 Final - pwn</title><link>https://blog.circleo.us/posts/hacktoday-2019-final-pwn/</link><pubDate>Tue, 27 Aug 2019 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/hacktoday-2019-final-pwn/</guid><description>&lt;h2 id="vmxck"&gt;vmxck&lt;/h2&gt;
&lt;p&gt;Desain awal soal ini sebenarnya ada hubungan dengan virtualisasi pada mesin dan bukan termasuk bagian dari &lt;em&gt;pwn&lt;/em&gt;. Iya, ini awalnya akan dijadikan soal reversing dengan register state based vm dengan &lt;code&gt;kvm&lt;/code&gt;. &lt;img src="https://imgs.xkcd.com/comics/xkcde.png" alt="vm di dalam vm"&gt;&lt;em&gt;vm di dalam vm&lt;/em&gt; Beberapa hari sebelum final, input soal-soal untuk reversing ternyata udah lumayan banyak, rencana untuk lanjut dan menyelesaikan soal ini jadi gagal, wkwkw. Agak malas untuk memikirkan ide lain, saya pakai ide &amp;ldquo;vm&amp;rdquo; lagi dan gak berbeda jauh dari soal tahun lalu &lt;code&gt;anoneanone&lt;/code&gt;. Soal ini masih sekitar brainfuck, &lt;em&gt;seharusnya&lt;/em&gt; (belum di-cek :p) tidak ada overflow pada input dan double free. Bug justru terletak pada OOB akses data cell.&lt;/p&gt;</description></item><item><title>HackToday 2019 Quals - pwn</title><link>https://blog.circleo.us/posts/hacktoday-2019-quals-pwn/</link><pubDate>Mon, 26 Aug 2019 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/hacktoday-2019-quals-pwn/</guid><description>&lt;p&gt;Ini akan menjadi seri ke-tiga pada seri &lt;em&gt;writeup&lt;/em&gt; HackToday 2019, kali ini saya akan menulis beberapa editorial untuk soal-soal pwn pada kualifikasi HackToday 2019.&lt;/p&gt;
&lt;h2 id="ezrop"&gt;ezrop&lt;/h2&gt;
&lt;p&gt;Desain awal soal sebenarnya benar-benar sederhana, key value memory database system, dimana seseorang dapat melihat/mengubah isi value dari suatu key dan posisinya bisa &lt;em&gt;out-of-bound&lt;/em&gt;. Yep, tanpa perubahan apapun pada isi memorynya. Tidak tahu kapan persis mulainya, tapi saya merasa soal ini terlalu mudah sehingga mengalami banyak perubahan yang membuat ini tidak benar-benar &amp;ldquo;ez&amp;rdquo;. Puncak kerumitannya, yang harus dilakukan adalah leak value canary lewat auxiliary vector&lt;a href="https://www.gnu.org/software/libc/manual/html_node/Auxiliary-Vector.html"&gt;[1]&lt;/a&gt;&lt;a href="https://lwn.net/Articles/519085/"&gt;[2]&lt;/a&gt; karena saya mem-&lt;em&gt;poison&lt;/em&gt; hampir semua value di memory serta pie+offset tepat pada RBP (leak PIE jadi tidak berguna disini). Beberapa hari sebelum kualifikasi dimulai, saya tersadar, ini soal &amp;ldquo;ez&amp;rdquo;, jadilah perubahan final soal ini, tanpa adanya &lt;em&gt;poison&lt;/em&gt; pada value pada RBP. Sebagai gambaran, ini yang terjadi ketika sebelum perubahan final terjadi,&lt;/p&gt;</description></item><item><title>A Long Rant and FBCTF 2019 - kpets</title><link>https://blog.circleo.us/posts/a-long-rant-and-fbctf-2019-kpets/</link><pubDate>Sat, 29 Jun 2019 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/a-long-rant-and-fbctf-2019-kpets/</guid><description>&lt;h2 id="rant"&gt;rant&lt;/h2&gt;
&lt;p&gt;After reading auxy blog about &lt;a href="http://www.auxy.xyz/tutorial/2019/06/10/Linux-Exp-Tutorial.html"&gt;linux kernel exploitation tutorial&lt;/a&gt;, I kinda wanted to write this into a blog post. I&amp;rsquo;m still rather new to kernel pwn, I&amp;rsquo;ve been learning this since there is two kernel pwn appearances in secfest CTF around May 2019 &lt;code&gt;xtore&lt;/code&gt; and &lt;code&gt;brainfuck64&lt;/code&gt;. Reason? I need something beside learning classical heap pwn and might be a good mood booster to do another large codebase code review.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;brainfuck64&lt;/code&gt; seems like a classic heap challenge, but in kernelspace. I didn&amp;rsquo;t solve it tho, I literally just started this kernel pwn journey and didn&amp;rsquo;t even know what&amp;rsquo;s this &lt;code&gt;IOCTL&lt;/code&gt; thing. Shortly, after ctf ends, I read &lt;a href="https://kileak.github.io/ctf/2019/secfest-brainfuck64/"&gt;kileak writeup&lt;/a&gt;, seems like my assumption is correct.&lt;/p&gt;</description></item><item><title>Defcon Qual 2019 - Babyheap</title><link>https://blog.circleo.us/posts/defcon-qual-2019-babyheap/</link><pubDate>Tue, 14 May 2019 00:00:00 +0700</pubDate><guid>https://blog.circleo.us/posts/defcon-qual-2019-babyheap/</guid><description>&lt;h2 id="intro"&gt;intro&lt;/h2&gt;
&lt;p&gt;So, we get a heap pwn running with glibc 2.29 :0. Yes, this version of glibc already has the juicy tcache and introduce some mitigation (no simple double free, etc.).&lt;/p&gt;
&lt;p&gt;Running this binary,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-----Yet Another Babyheap!-----
[M]alloc
[F]ree
[S]how
[E]xit
------------------------
Command:
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;[M]alloc&lt;/code&gt;, basically create chunk with 2 type of size 0xF8 and 0x178. Any size lower than that are set to the higher bound. So, for example, if you try to create chunk with size of 1, you&amp;rsquo;ll get &lt;code&gt;malloc(0xF8)&lt;/code&gt; and chunk size of 0xF9 you&amp;rsquo;ll get &lt;code&gt;malloc(0x178)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[F]ree&lt;/code&gt;, &lt;code&gt;memset(content, 0, chunk_request_size)&lt;/code&gt; then &lt;code&gt;free()&lt;/code&gt;, pointer also get NULLed at the end. So, no UaF i guess?&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[S]how&lt;/code&gt;, print the content of chunk.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[E]xit&lt;/code&gt;, exit, ofc.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="off-by-one"&gt;off-by-one&lt;/h2&gt;
&lt;p&gt;In &lt;code&gt;[M]alloc&lt;/code&gt;, user input to fill content handled like this,&lt;/p&gt;</description></item></channel></rss>